---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import { getCountryInfo } from "../lib/country-context";

// Get country information
const countryInfo = getCountryInfo();
const { name: countryName } = countryInfo;

// Sample news categories
const newsCategories = [
  { id: "all", name: "All News" },
  { id: "events", name: "Events" },
  { id: "announcements", name: "Announcements" },
  { id: "competitions", name: "Competitions" },
  { id: "training", name: "Training" },
  { id: "results", name: "Results" }
];

// Sample news items - in a real implementation, this would come from a database or API
const newsItems = [
  {
    id: 1,
    title: "Registration Now Open for 2025 Robotics Competition",
    date: "June 15, 2025",
    excerpt: "Join us for the biggest robotics event of the year. Registration is now open for all categories.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/competition.jpg",
    category: "competitions",
    author: "Robolution Team",
    tags: ["competition", "registration", "2025"]
  },
  {
    id: 2,
    title: "New Training Workshops Announced",
    date: "June 10, 2025",
    excerpt: "Learn from industry experts in our upcoming series of training workshops focused on advanced robotics.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/workshop.jpg",
    category: "training",
    author: "Education Department",
    tags: ["workshop", "training", "robotics"]
  },
  {
    id: 3,
    title: "Partnership with Local Universities Announced",
    date: "June 5, 2025",
    excerpt: "We're excited to announce new partnerships with leading universities to advance robotics education.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/partnership.jpg",
    category: "announcements",
    author: "Partnerships Team",
    tags: ["partnership", "education", "university"]
  },
  {
    id: 4,
    title: "Results from the Regional Robotics Championship",
    date: "May 28, 2025",
    excerpt: "Check out the winners and highlights from our recent Regional Robotics Championship.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/results.jpg",
    category: "results",
    author: "Competition Committee",
    tags: ["results", "championship", "winners"]
  },
  {
    id: 5,
    title: "Annual Robotics Conference - Save the Date",
    date: "May 20, 2025",
    excerpt: "Mark your calendars for our annual robotics conference featuring keynote speakers from industry leaders.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/conference.jpg",
    category: "events",
    author: "Events Team",
    tags: ["conference", "event", "speakers"]
  },
  {
    id: 6,
    title: "Robotics Scholarship Program Launched",
    date: "May 15, 2025",
    excerpt: "We're proud to announce our new scholarship program for talented students interested in robotics.",
    content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc. Nullam auctor, nisl eget ultricies tincidunt, nunc nisl aliquam nisl, eget aliquam nunc nisl eget nunc.",
    image: "/images/news/scholarship.jpg",
    category: "announcements",
    author: "Education Department",
    tags: ["scholarship", "education", "students"]
  }
];

// Get active category from URL query parameter, default to "all"
const urlSearchParams = Astro.url.searchParams;
const activeCategory = urlSearchParams.get("category") || "all";

// Filter news items by category (if not "all")
const filteredNews = activeCategory === "all" 
  ? newsItems 
  : newsItems.filter(item => item.category === activeCategory);
---

<Layout title={`News | Robolution ${countryName}`}>
  <Navbar slot="nav" />
  
  <div class="page-header">
    <div class="container">
      <h1 class="page-title">News & Updates</h1>
      <p class="page-subtitle">Stay informed with the latest news and announcements from Robolution {countryName}</p>
    </div>
  </div>
  
  <div class="news-page">
    <div class="container">
      <!-- Category Filter -->
      <div class="category-filter">
        <div class="filter-tabs">
          {newsCategories.map(category => (
            <a 
              href={`/news?category=${category.id}`} 
              class={`filter-tab ${activeCategory === category.id ? 'active' : ''}`}
            >
              {category.name}
            </a>
          ))}
        </div>
        
        <!-- Search Form (placeholder for now) -->
        <div class="search-container">
          <form class="search-form">
            <input type="text" placeholder="Search news..." class="search-input" />
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i>
            </button>
          </form>
        </div>
      </div>
      
      <!-- News Grid -->
      <div class="news-grid">
        {filteredNews.length > 0 ? (
          filteredNews.map(news => (
            <a href={`/news/${news.id}`} class="news-card">
              <div class="news-image-container">
                <img src={news.image || "/images/news/default.jpg"} alt={news.title} class="news-image" />
                <div class="news-category">{newsCategories.find(cat => cat.id === news.category)?.name}</div>
              </div>
              <div class="news-content">
                <div class="news-meta">
                  <div class="news-date">
                    <i class="far fa-calendar"></i> {news.date}
                  </div>
                  <div class="news-author">
                    <i class="far fa-user"></i> {news.author}
                  </div>
                </div>
                <h3 class="news-title">{news.title}</h3>
                <p class="news-excerpt">{news.excerpt}</p>
                <div class="news-read-more">Read more <i class="fas fa-arrow-right"></i></div>
              </div>
            </a>
          ))
        ) : (
          <div class="no-results">
            <i class="fas fa-search fa-3x"></i>
            <h3>No news found</h3>
            <p>We couldn't find any news for the selected category. Please try another category or check back later.</p>
            <a href="/news" class="btn btn-primary">View All News</a>
          </div>
        )}
      </div>
      
      <!-- Pagination (placeholder for now) -->
      <div class="pagination">
        <a href="#" class="pagination-prev disabled">
          <i class="fas fa-chevron-left"></i> Previous
        </a>
        <div class="pagination-pages">
          <a href="#" class="pagination-page active">1</a>
          <a href="#" class="pagination-page">2</a>
          <a href="#" class="pagination-page">3</a>
          <span class="pagination-ellipsis">...</span>
          <a href="#" class="pagination-page">10</a>
        </div>
        <a href="#" class="pagination-next">
          Next <i class="fas fa-chevron-right"></i>
        </a>
      </div>
    </div>
  </div>
  
  <Footer slot="footer" />
</Layout>

<style>
/* Page Header Styles */
.page-header {
  background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
  color: white;
  padding: 8rem 0 4rem;
  text-align: center;
}

.page-title {
  font-size: 3rem;
  font-weight: 800;
  margin-bottom: 1rem;
}

.page-subtitle {
  font-size: 1.2rem;
  max-width: 700px;
  margin: 0 auto;
  opacity: 0.9;
}

/* News Page Styles */
.news-page {
  padding: 4rem 0;
  background-color: #f8f9fa;
}

/* Category Filter Styles */
.category-filter {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2.5rem;
  background-color: white;
  padding: 1rem;
  border-radius: var(--border-radius);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.filter-tabs {
  display: flex;
  gap: 0.5rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
}

.filter-tab {
  padding: 0.5rem 1rem;
  border-radius: var(--border-radius);
  font-weight: 500;
  color: var(--text-color);
  transition: all 0.2s ease;
  white-space: nowrap;
}

.filter-tab:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.filter-tab.active {
  background-color: var(--primary-color);
  color: white;
}

.search-container {
  flex-shrink: 0;
}

.search-form {
  display: flex;
  align-items: center;
}

.search-input {
  padding: 0.5rem 1rem;
  border: 1px solid #ddd;
  border-radius: var(--border-radius) 0 0 var(--border-radius);
  outline: none;
  width: 200px;
}

.search-button {
  background-color: var(--primary-color);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
  cursor: pointer;
}

/* News Grid Styles */
.news-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 2rem;
  margin-bottom: 3rem;
}

.news-card {
  background-color: white;
  border-radius: var(--border-radius);
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  display: flex;
  flex-direction: column;
  height: 100%;
}

.news-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
}

.news-image-container {
  height: 220px;
  overflow: hidden;
  position: relative;
}

.news-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.news-card:hover .news-image {
  transform: scale(1.1);
}

.news-category {
  position: absolute;
  bottom: 10px;
  left: 10px;
  background-color: var(--primary-color);
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 500;
}

.news-content {
  padding: 1.5rem;
  flex-grow: 1;
  display: flex;
  flex-direction: column;
}

.news-meta {
  display: flex;
  gap: 1.5rem;
  margin-bottom: 1rem;
  font-size: 0.9rem;
  color: #6c757d;
}

.news-date, .news-author {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.news-title {
  font-size: 1.25rem;
  margin-bottom: 1rem;
  color: var(--text-color);
  line-height: 1.4;
}

.news-excerpt {
  color: #6c757d;
  margin-bottom: 1.5rem;
  line-height: 1.6;
  flex-grow: 1;
}

.news-read-more {
  color: var(--primary-color);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  align-self: flex-start;
  margin-top: auto;
}

/* No Results Styles */
.no-results {
  grid-column: 1 / -1;
  text-align: center;
  padding: 4rem 2rem;
  background-color: white;
  border-radius: var(--border-radius);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

.no-results i {
  color: var(--primary-color);
  opacity: 0.5;
  margin-bottom: 1.5rem;
}

.no-results h3 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--text-color);
}

.no-results p {
  color: #6c757d;
  margin-bottom: 2rem;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

/* Pagination Styles */
.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
}

.pagination-prev,
.pagination-next {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: var(--border-radius);
  background-color: white;
  color: var(--text-color);
  font-weight: 500;
  transition: all 0.2s ease;
}

.pagination-prev:hover,
.pagination-next:hover {
  background-color: var(--primary-color);
  color: white;
}

.pagination-prev.disabled,
.pagination-next.disabled {
  opacity: 0.5;
  pointer-events: none;
}

.pagination-pages {
  display: flex;
  gap: 0.25rem;
}

.pagination-page {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: var(--border-radius);
  background-color: white;
  color: var(--text-color);
  transition: all 0.2s ease;
}

.pagination-page:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.pagination-page.active {
  background-color: var(--primary-color);
  color: white;
}

.pagination-ellipsis {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2.5rem;
  height: 2.5rem;
}

/* Responsive Styles */
@media (max-width: 1024px) {
  .news-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .page-title {
    font-size: 2.5rem;
  }
  
  .category-filter {
    flex-direction: column;
    gap: 1rem;
  }
  
  .search-container {
    width: 100%;
  }
  
  .search-form {
    width: 100%;
  }
  
  .search-input {
    width: 100%;
  }
  
  .news-grid {
    grid-template-columns: 1fr;
  }
  
  .pagination {
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
  }
}

@media (max-width: 576px) {
  .page-header {
    padding: 7rem 0 3rem;
  }
  
  .page-title {
    font-size: 2rem;
  }
  
  .filter-tabs {
    width: 100%;
    justify-content: flex-start;
  }
}
</style> 