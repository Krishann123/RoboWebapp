---
import Layout from "../../layouts/Layout.astro";
import UrlFixer from "@/components/UrlFixer.astro";

// Get the country from the URL
export function getStaticPaths() {
  // This function allows for multiple dynamic routes
  return [
    { params: { country: 'dubai' } },
    { params: { country: 'singapore' } },
    // Add more countries as needed
  ];
}

const { country } = Astro.params;

// Set country info in headers for the Layout component
Astro.response.headers.set('x-country-site', JSON.stringify({
  name: country.charAt(0).toUpperCase() + country.slice(1),
  slug: country,
  // Default styles (will be overridden by database values when available)
  customStyles: {
    primaryColor: '#00008b',
    secondaryColor: '#FFB366',
    accentColor: '#6AAAFF',
    backgroundColor: '#FFFFFF'
  }
}));

// Add header to prevent redirect loops
Astro.response.headers.set('X-Forwarded-From-Astro', 'true');

// Forward to the original Registration.astro page
// This approach keeps the original page intact but makes it accessible through country routes
const { default: OriginalRegistration } = await import('../registration.astro');
---

<OriginalRegistration {...Astro.props} />
<UrlFixer /> 