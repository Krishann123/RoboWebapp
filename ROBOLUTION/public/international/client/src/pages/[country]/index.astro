---
import Jumbotron from "../../components/Home/Jumbotron.astro";
import Layout from "../../layouts/Layout.astro";
import Join from "../../components/Home/Joinrobo.astro";
import Package from "../../components/Home/Package.astro";
import Robolution from "@/components/Home/Robolution.astro";
import Highlights from "@/components/Home/Highlights.astro";
import FrequentlyAsk from "@/components/Home/FrequentlyAsk.astro";
import Partners from "@/components/Home/Partners";
import NewsAndUpdate from "@/components/Home/NewsAndUpdate.astro";
import UrlFixer from "@/components/UrlFixer.astro";

// Get the country from the URL
export function getStaticPaths() {
  // This function allows for multiple dynamic routes
  // We'll return just the countries we want to support initially
  return [
    { params: { country: 'dubai' } },
    { params: { country: 'singapore' } },
    // Add more countries as needed
  ];
}

const { country } = Astro.params;

// Set country info in headers for the Layout component
Astro.response.headers.set('x-country-site', JSON.stringify({
  name: country.charAt(0).toUpperCase() + country.slice(1),
  slug: country,
  // Default styles (will be overridden by database values when available)
  customStyles: {
    primaryColor: '#00008b',
    secondaryColor: '#FFB366',
    accentColor: '#6AAAFF',
    backgroundColor: '#FFFFFF'
  }
}));

// Add header to prevent redirect loops
Astro.response.headers.set('X-Forwarded-From-Astro', 'true');
---

<Layout title={`Erovoutika ${country.charAt(0).toUpperCase() + country.slice(1)} - Home`}>
    <Jumbotron />
    <Robolution />
    <Package />
    <Highlights />
    <Join />
    <NewsAndUpdate />
    <FrequentlyAsk />
    <Partners />
    <UrlFixer />
</Layout>

<style>
    /* Ensure all links work properly with country context */
    :global(a[href^="/"]:not([href^="//"]):not([href^="/home"])) {
        /* Prepend country path to relative links */
        content: attr(href);
    }
</style> 